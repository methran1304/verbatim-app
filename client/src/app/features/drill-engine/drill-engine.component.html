<div class="drill-engine-center" (click)="focusInput()">
  <app-drill-toolbar
    [wpm]="wpm"
    [accuracy]="accuracy"
    [remainingSeconds]="remainingSeconds"
    [currentWordIndex]="currentWordIndex"
    [totalWords]="sourceText.length"
    [drillPreference]="drillPreferences"
    [isTyping]="isTyping"
    [disabled]="showPostDrillOverlay"
    [forceCollapsed]="showPostDrillOverlay"
    (restart)="onRestart()"
    (newDrill)="onNewDrill()"
    (drillPreferenceChange)="onDrillPreferenceChange($event)"
  ></app-drill-toolbar>

  <app-drill-text
    [sourceText]="sourceText"
    [typedInput]="typedText"
    [currentWordIndex]="currentWordIndex"
    [currentCharIndex]="currentCharIndex"
    [isFocused]="isInputFocused"
    [showPostDrillOverlay]="showPostDrillOverlay"
    (postDrillRestart)="onRestart()"
    (postDrillSubmit)="onPostDrillSubmit()"
  ></app-drill-text>

  <app-virtual-keyboard
    [inputValue]="currentInput"
    [isDarkTheme]="isDarkMode"
  ></app-virtual-keyboard>

  @if (isDrillActive) {
  <app-drill-input (keyTyped)="onKeyTyped($event)" (focusEvent)="onInputFocus()"
    (blurEvent)="onInputBlur()"></app-drill-input>
  }
</div>