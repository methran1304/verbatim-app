@if (show) {
  <div class="player-panel">
    <nz-card class="player-panel-card">
      <div class="player-panel-header">
        <h3 class="panel-title">
          <span nz-icon nzType="team" nzTheme="outline"></span>
          Players
        </h3>
        <span class="player-count">{{ players.length }}/4</span>
      </div>

      <div class="player-list">
        @if (players.length === 0) {
          <div class="empty-state">
            <span nz-icon nzType="user-add" nzTheme="outline"></span>
            <p>No players yet</p>
            <span class="empty-hint">Share the room code to invite players</span>
          </div>
        } @else {
          <div class="player-list-container">
            @for (player of players; track player.userId) {
              <div class="player-item">
                <div class="player-info">
                  <div class="player-avatar-section">
                    <nz-avatar 
                      [nzText]="getPlayerAvatarText(player)"
                      [nzSize]="40"
                      class="player-avatar">
                    </nz-avatar>
                    @if (player.isCreator) {
                      <span nz-icon nzType="crown" nzTheme="fill" class="creator-badge"></span>
                    }
                  </div>

                  <div class="player-details">
                    <div class="player-name-section">
                      <span class="player-name" [nz-tooltip]="getPlayerTooltip(player)">
                        {{ player.username }}
                      </span>
                      @if (player.userId === currentUserId) {
                        <span class="current-user-badge">You</span>
                      }
                    </div>
                    
                    <div class="player-stats">
                      <span class="player-level">Level {{ player.level }}</span>
                      @if (isActiveDrill && player.progress !== undefined) {
                        <div class="progress-section">
                          <nz-progress 
                            [nzPercent]="player.progress" 
                            [nzSize]="'small'"
                            [nzShowInfo]="false"
                            [nzStrokeColor]="player.progress === 100 ? '#52c41a' : '#1890ff'">
                          </nz-progress>
                        </div>
                      }
                    </div>
                  </div>

                  <div class="player-status-section">
                    <nz-badge 
                      [nzStatus]="getPlayerStatusColor(player)" 
                      [nzText]="getPlayerStatus(player)"
                      class="status-badge">
                    </nz-badge>
                    
                    @if (canKickPlayer(player)) {
                      <nz-popconfirm
                        nzTitle="Kick this player?"
                        nzOkText="Yes"
                        nzCancelText="No"
                        (nzOnConfirm)="onKickPlayer(player.userId)">
                        <button 
                          nz-button 
                          nzType="text" 
                          nzSize="small"
                          nzDanger
                          class="kick-button">
                          <span nz-icon nzType="user-delete" nzTheme="outline"></span>
                        </button>
                      </nz-popconfirm>
                    }
                  </div>
                </div>
              </div>
            }
          </div>
        }
      </div>
    </nz-card>
  </div>
}


